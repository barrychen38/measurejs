/*! measure.min.js v1.0.4 | Barry Chen */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Measure=b()}(this,function(){var a=function(a){switch(this._obj=document.querySelector(a.target),this._width=a.size,this._way=a.way,this._isNavbar=a.isNavbar,this._unit=a.unit,this._radius=2,this._left=10,this._top=10,this._color="#F00",this._isNavbar?this._navBarHeight=128:this._navBarHeight=0,this._unit){case"px":this._isHundred=1;break;case"rem":this._isHundred=100}},b=a.prototype,c=document.createElement("div");c.classList.add("data"),c.innerHTML='<p><span class="p">top</span>: <span class="top"></span><br><span class="p">left</span>: <span class="left"></span></p>',document.body.appendChild(c);var d=document.querySelector(".data"),e=document.querySelector(".top"),f=document.querySelector(".left"),g=d.offsetWidth,h=d.offsetHeight;window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;return b.whichPhone=function(){var a=this._width,b=document.createElement("meta");switch(b.name="viewport",a){case 640:b.content="width="+a+",target-densitydpi=device-dpi,maximum-scale=1,user-scalable=no",this._iPhone=5,this._height=1136;break;case 750:b.content="width="+a+",target-densitydpi=device-dpi,maximum-scale=1,user-scalable=no",this._iPhone=6,this._height=1334}document.getElementsByTagName("head")[0].appendChild(b)},b.createCanvas=function(){this.whichPhone();var a=this._obj;this._canvas=document.createElement("canvas"),this._canvas.width=this._width,this._canvas.height=this._height,this._canvas.style.width=this._width+"px",this._canvas.style.height=this._height+"px",this._canvas.id="measure",a.appendChild(this._canvas),this._image=a.childNodes[1],a.childNodes[1].style.display="none"},b.checkPosition=function(a,b,c,d){var e,f,i=this._width-(2*this._left+g),j=this._height-(2*this._top+h);return a>i&&b<=j&&(e=a-this._left-g,f=d),b>j&&a<=i&&(e=c,f=b-this._top-h),a>i&&b>j&&(e=a-this._left-g,f=b-this._top-h),a<=i&&b<=j&&(e=c,f=d),e+this._left+g>=this._width&&(e=this._width-this._left-g),e<=this._left&&(e=this._left),f+this._top+h>=this._height&&(f=this._height-this._left-h),f<=this._navBarHeight+this._top&&(f=this._navBarHeight+this._top),{x:e,y:f}},b.setStyle=function(a,b){a.style.transform=a.style.webkitTransform="translate3d("+b.x+"px,"+b.y+"px, 0)"},b.keyControl=function(a,b,c){function g(b,c){return b>=k&&(b=k),b<=m&&(b=m),c<=n&&(c=n),c>=l&&(c=l),a.save(),a.clearRect(0,0,i._width,i._height),a.drawImage(i._image,0,0),a.beginPath(),a.moveTo(0,c),a.lineTo(i._width,c),a.moveTo(b,0),a.lineTo(b,i._height),a.stroke(),a.restore(),{x:b,y:c}}var h,i=this,j=1,k=i._width,l=i._height,m=0,n=128,o=b,p=c,q=o+i._left,r=p+i._top,s=Math.round(o)/i._isHundred,t=Math.round(p-i._navBarHeight)/i._isHundred,u=!1,v={moveLeft:function(){o-=j,o<=m&&(o=m),q=o+i._left,h=g(o,p),s=Math.round(h.x)/i._isHundred},moveUp:function(){p-=j,p<=n&&(p=n),r=p+i._top,h=g(o,p),t=Math.round(h.y-i._navBarHeight)/i._isHundred},moveRight:function(){o+=j,o>=k&&(o=k),q=o+i._left,h=g(o,p),s=Math.round(h.x)/i._isHundred},moveDown:function(){p+=j,p>=l&&(p=l),r=p+i._top,h=g(o,p),t=Math.round(h.y-i._navBarHeight)/i._isHundred}};document.body.onkeydown=function(a){var g=a.keyCode;switch(g){case 37:case 65:v.moveLeft();break;case 38:case 87:v.moveUp();break;case 39:case 68:v.moveRight();break;case 40:case 83:v.moveDown()}var h=i.checkPosition(o,p,q,r);f.innerHTML=s+i._unit,b>=0&&c>=i._navBarHeight?(e.innerHTML=t+i._unit,i.setStyle(d,h)):(e.innerHTML=0+i._unit,d.style.transform=d.style.webkitTransform="translate3d("+h.x+"px,"+(i._navBarHeight+i._top)+"px, 0)")},document.body.onkeyup=function(){u||console.info(d.innerText)}},b.measure=function(){var a=this;a.createCanvas();var b=a._canvas.getContext("2d");a._image.onload=function(){b.drawImage(a._image,0,0)},b.strokeStyle=a._color,b.lineWidth=1,a._canvas.addEventListener("touchstart",function(c){var g=c.touches[0].pageX,h=c.touches[0].pageY;a.keyControl(b,g,h),b.clearRect(0,0,a._width,a._height),b.drawImage(a._image,0,0),b.beginPath();var i=Math.round(g)/a._isHundred,j=Math.round(h-a._navBarHeight)/a._isHundred;f.innerHTML=i+a._unit;var k=a._left+g,l=a._top+h,m=a.checkPosition(g,h,k,l);g>=0&&h>=a._navBarHeight?(b.moveTo(0,h),b.lineTo(a._width,h),b.moveTo(g,0),b.lineTo(g,a._height),e.innerHTML=j+a._unit,a.setStyle(d,m)):(e.innerHTML=0+a._unit,b.arc(g,a._navBarHeight,a._radius,0,2*Math.PI),d.style.transform=d.style.webkitTransform="translate3d("+m.x+"px,"+(a._navBarHeight+a._top)+"px, 0)"),d.style.opacity=1,b.stroke(),console.info(d.innerText)},!1)},a});